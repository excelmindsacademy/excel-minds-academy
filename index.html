<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Excel Minds Academy â€“ Student Management</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body{font-family:Arial;background:#eef2f5;padding:15px}
h2{text-align:center;color:#0d47a1}
form,table{background:#fff;padding:15px;border-radius:8px;margin-bottom:20px}
input,select,button{width:100%;padding:10px;margin:6px 0}
button{background:#0d47a1;color:white;border:none;border-radius:5px}
.whatsapp{background:#25D366}
.call{background:#ff5722}
.export{background:#ff9800}
table{width:100%;border-collapse:collapse}
th,td{border:1px solid #ccc;padding:6px;font-size:13px;text-align:center}
</style>
</head>

<body>

<h2>ðŸ“˜ Excel Minds Academy â€“ Student Entry</h2>

<form id="form">
<input id="studentName" placeholder="Student Name" required>
<input id="parentName" placeholder="Parent Name" required>
<input id="mobile" placeholder="Mobile Number" required>

<select id="class">
<option>6th</option><option>7th</option><option>8th</option>
<option>9th</option><option>10th</option>
</select>

<select id="board">
<option>SSC</option><option>CBSE</option><option>ICSE</option>
</select>

<input id="totalFees" placeholder="Total Fees" type="number" required>

<select id="plan">
<option>Yearly</option>
<option>Half-Yearly</option>
<option>Quarterly</option>
</select>

<input id="paid" placeholder="Paid Amount" type="number" required>
<input id="nextDate" type="date" required>

<button type="submit">Save Record</button>
</form>

<button class="export" onclick="exportExcel()">Export to Excel</button>

<table>
<thead>
<tr>
<th>Student</th><th>Parent</th><th>Mobile</th>
<th>Class</th><th>Fees</th><th>Paid</th><th>Due</th>
<th>Plan</th><th>Next Date</th><th>Call</th><th>WhatsApp</th>
</tr>
</thead>
<tbody id="list"></tbody>
</table>

<script>
let records = JSON.parse(localStorage.getItem("ema") || "[]");

function load(){
let html="";
records.forEach((r,i)=>{
html+=`<tr>
<td>${r.student}</td>
<td>${r.parent}</td>
<td>${r.mobile}</td>
<td>${r.class}</td>
<td>${r.total}</td>
<td>${r.paid}</td>
<td>${r.due}</td>
<td>${r.plan}</td>
<td>${r.next}</td>
<td><a href="tel:${r.mobile}"><button class="call">Call</button></a></td>
<td><button class="whatsapp" onclick="msg(${i})">Send</button></td>
</tr>`;
});
list.innerHTML=html;
}
load();

form.onsubmit=e=>{
e.preventDefault();
let total=+totalFees.value;
let paidAmt=+paid.value;
let data={
student:studentName.value,
parent:parentName.value,
mobile:mobile.value,
class:document.getElementById("class").value,
board:board.value,
total:total,
paid:paidAmt,
due:total-paidAmt,
plan:plan.value,
next:nextDate.value
};
records.push(data);
localStorage.setItem("ema",JSON.stringify(records));
form.reset();
load();
};

function msg(i){
let r=records[i];
let text=`Excel Minds Academy Fee Reminder%0A
Student: ${r.student}%0A
Total Fees: ${r.total}%0A
Paid: ${r.paid}%0A
Due: ${r.due}%0A
Next Date: ${r.next}`;
window.open(`https://wa.me/918208827251?text=${text}`);
}

function exportExcel(){
let csv="Student,Parent,Mobile,Class,Total,Paid,Due,Plan,NextDate\n";
records.forEach(r=>{
csv+=`${r.student},${r.parent},${r.mobile},${r.class},${r.total},${r.paid},${r.due},${r.plan},${r.next}\n`;
});
let blob=new Blob([csv]);
let a=document.createElement("a");
a.href=URL.createObjectURL(blob);
a.download="EMA_Records.csv";
a.click();
}
</script>

</body>
</html>
